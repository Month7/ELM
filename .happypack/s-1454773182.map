{"version":3,"sources":["src\\js\\common\\region.js"],"names":["render","Symbol","event","Region","opts","container","name","then","regionData","data","tpl","present","innerHTML","$provinceSelect","$citySelect","$areaSelect","$result","provinceSelected","citySelected","areaSelected","provinceOptions","item","id","provinceChange","index","i","parseInt","value","citys","city","cityOptions","cityChange","areas","filter","district","areaOptions","areaChange","initData","Array","isArray","onchange"],"mappings":"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","file":"region.js","sourceRoot":"D:/account-system-sdk","sourcesContent":["import {getId as $} from './utils.js';\r\nimport {fetchJson} from './fetch.js';\r\n\r\nconst render =Symbol('render');\r\nconst event =Symbol('event');\r\n\r\nclass Region{\r\n    constructor(opts){\r\n        if(!opts.container){\r\n            throw '请填写container配置';\r\n        }\r\n        if(!opts.name){\r\n            throw '请填写name配置';\r\n        }\r\n        else{\r\n            this[render](opts).then((regionData)=>{\r\n                this[event](opts,regionData);\r\n            });\r\n        }\r\n    }\r\n    async [render](opts){\r\n        let regionData=await fetchJson('/region-data',{});\r\n        regionData=regionData.data;\r\n        const tpl=`\r\n         <div class=\"region-select-wrapper\">\r\n            <select id=\"region-province-select\"></select>\r\n            <select id=\"region-city-select\"></select>\r\n            <select id=\"region-area-select\"></select>\r\n            <input id=\"region-selected\" name=\"${ opts.name }\" type=\"hidden\" valid=\"${ opts.present ? 'present' : ''}\">\r\n        </div>\r\n        `;\r\n        opts.container.innerHTML=tpl;\r\n\r\n       \r\n        return regionData;\r\n        \r\n    }\r\n    [event](opts,regionData){\r\n        const $provinceSelect = $('region-province-select');\r\n        const $citySelect = $('region-city-select');\r\n        const $areaSelect = $('region-area-select');\r\n        const $result = $('region-selected');\r\n\r\n        let provinceSelected;\r\n        let citySelected;\r\n        let areaSelected;\r\n        let provinceOptions='<option></option>';\r\n\r\n        for(let item of regionData){\r\n            provinceOptions+=`<option value=\"${item.id}\">${item.name}</option>`\r\n        }\r\n        $provinceSelect.innerHTML = provinceOptions;\r\n\r\n        const provinceChange=(index)=>{\r\n            const i=index||parseInt($provinceSelect.value);\r\n            \r\n            const citys=regionData[i-1].city;\r\n            let cityOptions='';\r\n            provinceSelected=i;\r\n            for(let item of citys){\r\n                cityOptions+=`<option value=\"${item.id}\">${item.name}</option>`\r\n            }\r\n            $citySelect.innerHTML = cityOptions;\r\n            if(index){\r\n                $provinceSelect.value=index;\r\n            }\r\n        }\r\n        const cityChange=(index)=>{\r\n            let areas=regionData[provinceSelected-1].city.filter((item)=>{\r\n                return item.id==parseInt($citySelect.value);\r\n            })[0].district;\r\n        \r\n            let areaOptions='';\r\n            citySelected=parseInt($citySelect.value);\r\n            for(let item of areas){\r\n                areaOptions+=`<option value=\"${item.id}\">${item.name}</option>`\r\n            }\r\n            $areaSelect.innerHTML = areaOptions;\r\n            if(index){\r\n                $citySelect.value=index;\r\n            }\r\n        }\r\n        const areaChange=(index)=>{\r\n            areaSelected=parseInt($areaSelect.value);\r\n            $result.value=provinceSelected+','+citySelected+areaSelected;\r\n            if(index){\r\n                $areaSelect.value=index;\r\n            }\r\n        }\r\n        if(opts.initData && Array.isArray(opts.initData)){\r\n            \r\n            const data=opts.initData;\r\n           \r\n            if(data[0]){\r\n                \r\n                provinceChange(data[0]);\r\n            }\r\n            if(data[1]){\r\n                cityChange(data[1]);\r\n            }\r\n            if(data[2]){\r\n                areaChange(data[2]);\r\n            }\r\n        }\r\n        $provinceSelect.onchange=()=>{\r\n            provinceChange();\r\n            cityChange();\r\n            areaChange();\r\n        };\r\n        $citySelect.onchange=()=>{\r\n            cityChange();\r\n            areaChange();\r\n        }\r\n        $areaSelect.onchange=()=>{\r\n            areaChange();\r\n        }\r\n    }\r\n}\r\n\r\nexport default Region;"]}